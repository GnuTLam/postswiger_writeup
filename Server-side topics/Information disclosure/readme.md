# Information disclosure

## Information Disclosure l√† g√¨?
Information Disclosure (hay c√≤n g·ªçi l√† Information Leakage) l√† t√¨nh tr·∫°ng m·ªôt website ho·∫∑c ·ª©ng d·ª•ng v√¥ t√¨nh ti·∫øt l·ªô c√°c th√¥ng tin nh·∫°y c·∫£m cho ng∆∞·ªùi d√πng kh√¥ng c√≥ quy·ªÅn truy c·∫≠p. Nh·ªØng th√¥ng tin n√†y c√≥ th·ªÉ bao g·ªìm:
- D·ªØ li·ªáu ng∆∞·ªùi d√πng: t√™n ƒëƒÉng nh·∫≠p, th√¥ng tin t√†i ch√≠nh, ƒë·ªãa ch·ªâ email, s·ªë ƒëi·ªán tho·∫°i.
- Th√¥ng tin nh·∫°y c·∫£m c·ªßa doanh nghi·ªáp: d·ªØ li·ªáu kinh doanh, chi·∫øn l∆∞·ª£c n·ªôi b·ªô, t√†i li·ªáu b·∫£o m·∫≠t.
- Chi ti·∫øt k·ªπ thu·∫≠t: c·∫•u tr√∫c th∆∞ m·ª•c, phi√™n b·∫£n ph·∫ßn m·ªÅm, m√£ ngu·ªìn, API keys, c·∫•u h√¨nh h·ªá th·ªëng.
Vi·ªác r√≤ r·ªâ th√¥ng tin k·ªπ thu·∫≠t c√≥ th·ªÉ kh√¥ng g√¢y h·∫≠u qu·∫£ tr·ª±c ti·∫øp ngay l·∫≠p t·ª©c nh∆∞ng l·∫°i l√† ƒëi·ªÉm kh·ªüi ƒë·∫ßu ƒë·ªÉ k·∫ª t·∫•n c√¥ng khai th√°c c√°c l·ªó h·ªïng b·∫£o m·∫≠t nghi√™m tr·ªçng h∆°n.

## Examples
- Ti·∫øt l·ªô c·∫•u tr√∫c th∆∞ m·ª•c: Qua file robots.txt ho·∫∑c li·ªát k√™ th∆∞ m·ª•c kh√¥ng ki·ªÉm so√°t.
- Truy c·∫≠p m√£ ngu·ªìn: Do ƒë·ªÉ l·ªô c√°c file backup nh∆∞ index.php~ ho·∫∑c backup.zip.
- Th√¥ng b√°o l·ªói chi ti·∫øt: Hi·ªÉn th·ªã t√™n b·∫£ng c∆° s·ªü d·ªØ li·ªáu, l·ªói SQL, stack trace.
- L·ªô th√¥ng tin nh·∫°y c·∫£m: L∆∞u API keys, credentials tr·ª±c ti·∫øp trong m√£ ngu·ªìn.
- Ph·∫£n h·ªìi ·ª©ng d·ª•ng kh√°c nhau: D·ª±a v√†o ph·∫£n h·ªìi l·ªói ƒë·ªÉ ƒëo√°n s·ª± t·ªìn t·∫°i c·ªßa t√†i kho·∫£n ho·∫∑c t√†i nguy√™n.

## Finding & Exploiting Information Disclosure
### Finding
üîç Ki·ªÉm Tra C·∫•u H√¨nh v√† C√°c File Nh·∫°y C·∫£m
- T√¨m ki·∫øm c√°c file c·∫•u h√¨nh nh·∫°y c·∫£m: Ki·ªÉm tra s·ª± t·ªìn t·∫°i c·ªßa c√°c file nh∆∞ `robots.txt`, `.git/`, `.env`, `backup.zip`, `config.php`. Nh·ªØng file n√†y th∆∞·ªùng ch·ª©a th√¥ng tin n·ªôi b·ªô nh∆∞ ƒë∆∞·ªùng d·∫´n, th√¥ng tin database, ho·∫∑c API key.
- Ph√¢n t√≠ch HTTP Headers: S·ª≠ d·ª•ng c√¥ng c·ª• nh∆∞ Burp Suite ho·∫∑c cURL ƒë·ªÉ ki·ªÉm tra c√°c header nh∆∞ `Server`, `X-Powered-By`, `Content-Security-Policy` nh·∫±m x√°c ƒë·ªãnh th√¥ng tin v·ªÅ phi√™n b·∫£n ph·∫ßn m·ªÅm, framework ƒëang s·ª≠ d·ª•ng.

üö© Th·ª≠ Nghi·ªám V·ªõi C√°c L·ªói (Error-Based Testing)
- T·∫°o ƒëi·ªÅu ki·ªán g√¢y l·ªói: C·ªë √Ω nh·∫≠p d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c thi·∫øu th√¥ng tin ƒë·ªÉ k√≠ch ho·∫°t th√¥ng b√°o l·ªói. V√≠ d·ª•: g·ª≠i y√™u c·∫ßu SQL sai c√∫ ph√°p ƒë·ªÉ ph√°t hi·ªán l·ªói SQL Injection ho·∫∑c l·ªói x√°c th·ª±c.
- Ph√¢n t√≠ch th√¥ng b√°o l·ªói chi ti·∫øt: T√¨m ki·∫øm c√°c th√¥ng b√°o l·ªói ch·ª©a th√¥ng tin nh·∫°y c·∫£m nh∆∞ t√™n b·∫£ng c∆° s·ªü d·ªØ li·ªáu, c·∫•u tr√∫c th∆∞ m·ª•c, ho·∫∑c stack trace chi ti·∫øt.
- Ki·ªÉm tra l·ªói HTTP: D√≤ t√¨m c√°c trang 404 (Not Found) v√† 500 (Internal Server Error) ƒë·ªÉ x√°c ƒë·ªãnh th√¥ng tin v·ªÅ c·∫•u tr√∫c h·ªá th·ªëng v√† d·ªãch v·ª• ƒëang ch·∫°y.

üìú Ph√¢n T√≠ch M√£ Ngu·ªìn v√† API
- Ki·ªÉm tra hard-coded credentials: T√¨m ki·∫øm th√¥ng tin nh·∫°y c·∫£m nh∆∞ API keys, m·∫≠t kh·∫©u, ho·∫∑c token x√°c th·ª±c trong c√°c file JavaScript, JSON ho·∫∑c c·∫•u h√¨nh ·ª©ng d·ª•ng.
- Ph√¢n t√≠ch API responses: Ki·ªÉm tra c√°c API ƒë·ªÉ ph√°t hi·ªán th√¥ng tin kh√¥ng c·∫ßn thi·∫øt ƒë∆∞·ª£c tr·∫£ v·ªÅ, nh∆∞ ID n·ªôi b·ªô, chi ti·∫øt v·ªÅ l·ªói ho·∫∑c d·ªØ li·ªáu nh·∫°y c·∫£m c·ªßa ng∆∞·ªùi d√πng kh√°c.

üõ†Ô∏è S·ª≠ D·ª•ng C√¥ng C·ª• H·ªó Tr·ª£
- Burp Suite: D√πng ƒë·ªÉ ph√¢n t√≠ch l∆∞u l∆∞·ª£ng HTTP/HTTPS, ki·ªÉm tra l·ªói v√† ph√°t hi·ªán c√°c th√¥ng tin r√≤ r·ªâ.
- Dirbuster/ffuf: T√¨m ki·∫øm c√°c th∆∞ m·ª•c ho·∫∑c file ·∫©n b·∫±ng c√°ch brute-force URL.
- Nmap: Qu√©t c·ªïng ƒë·ªÉ x√°c ƒë·ªãnh c√°c d·ªãch v·ª• ƒëang ch·∫°y, ph√°t hi·ªán c·∫•u h√¨nh sai ho·∫∑c d·ªãch v·ª• kh√¥ng c·∫ßn thi·∫øt.

### Exploiting
üéØ T·∫≠n D·ª•ng Th√¥ng Tin B·ªã R√≤ R·ªâ ƒê·ªÉ T·∫•n C√¥ng S√¢u H∆°n
- Khai th√°c API Keys: S·ª≠ d·ª•ng c√°c API key t√¨m ƒë∆∞·ª£c ƒë·ªÉ truy c·∫≠p tr√°i ph√©p v√†o h·ªá th·ªëng, l·∫•y th√¥ng tin nh·∫°y c·∫£m ho·∫∑c th·ª±c hi·ªán c√°c h√†nh ƒë·ªông kh√¥ng ƒë∆∞·ª£c ph√©p.
- T·∫•n c√¥ng SQL Injection: D·ª±a v√†o th√¥ng tin l·ªói c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ x√°c ƒë·ªãnh c·∫•u tr√∫c b·∫£ng, sau ƒë√≥ th·ª±c hi·ªán c√°c cu·ªôc t·∫•n c√¥ng SQL Injection nh·∫±m truy xu·∫•t d·ªØ li·ªáu b√≠ m·∫≠t.
- T·∫•n c√¥ng d·ª±a tr√™n th√¥ng tin h·ªá th·ªëng: S·ª≠ d·ª•ng c√°c th√¥ng tin nh∆∞ phi√™n b·∫£n ph·∫ßn m·ªÅm ho·∫∑c framework ƒë·ªÉ t√¨m c√°c l·ªó h·ªïng ƒë√£ bi·∫øt (CVE) v√† khai th√°c ch√∫ng.
- Privilege Escalation: Khi c√≥ th√¥ng tin v·ªÅ c·∫•u tr√∫c h·ªá th·ªëng, hacker c√≥ th·ªÉ t√¨m c√°ch leo thang ƒë·∫∑c quy·ªÅn ƒë·ªÉ ki·ªÉm so√°t nhi·ªÅu h∆°n h·ªá th·ªëng m·ª•c ti√™u.

üöÄ V√≠ D·ª• Th·ª±c T·∫ø
- R√≤ r·ªâ th√¥ng tin qua header HTTP: N·∫øu header `Server: Apache/2.4.49` xu·∫•t hi·ªán, hacker c√≥ th·ªÉ ki·ªÉm tra xem phi√™n b·∫£n n√†y c√≥ l·ªó h·ªïng n√†o kh√¥ng v√† khai th√°c b·∫±ng c√°c CVE t∆∞∆°ng ·ª©ng.
- Truy c·∫≠p file backup: Hacker t√¨m th·∫•y file `backup.zip` ch·ª©a m√£ ngu·ªìn, t·ª´ ƒë√≥ t√¨m ra l·ªó h·ªïng logic trong ·ª©ng d·ª•ng ƒë·ªÉ t·∫•n c√¥ng.
- Ti·∫øt l·ªô l·ªói chi ti·∫øt trong API: API tr·∫£ v·ªÅ l·ªói "Invalid SQL Syntax near 'SELECT * FROM users'", ƒë√¢y l√† th√¥ng tin gi√° tr·ªã ƒë·ªÉ t·∫•n c√¥ng SQL Injection.

## üíª Labs

### Lab: Information disclosure in error messages
**ERROR MESSAGE**
>GET /product?productId=1 HTTP/2

Th·ª≠ thay ƒë·ªïi payload nh∆∞ sau
>GET /product?productId=abcxyz HTTP/2

Third party: `Apache Struts 2 2.3.31` 

‚úÖ Key `2 2.3.31`

### Lab: Information disclosure on debug page
**Debugging Data**

- **Th√¥ng tin nh·∫°y c·∫£m th∆∞·ªùng b·ªã r√≤ r·ªâ qua log/debug:**
  - Gi√° tr·ªã c·ªßa **bi·∫øn session** c√≥ th·ªÉ b·ªã thao t√∫ng.
  - **T√™n m√°y ch·ªß** v√† **th√¥ng tin ƒëƒÉng nh·∫≠p** c·ªßa h·ªá th·ªëng back-end.
  - **T√™n file/th∆∞ m·ª•c** tr√™n server gi√∫p k·∫ª t·∫•n c√¥ng hi·ªÉu c·∫•u tr√∫c h·ªá th·ªëng.
  - **Kh√≥a m√£ h√≥a d·ªØ li·ªáu**, d·ªÖ b·ªã khai th√°c ƒë·ªÉ gi·∫£i m√£ d·ªØ li·ªáu nh·∫°y c·∫£m.

- **Nguy c∆° khi th√¥ng tin debug b·ªã l∆∞u tr·ªØ sai c√°ch:**
  - File log ri√™ng bi·ªát ch·ª©a th√¥ng tin chi ti·∫øt v·ªÅ tr·∫°ng th√°i runtime c·ªßa ·ª©ng d·ª•ng.
  - K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ khai th√°c th√¥ng tin n√†y ƒë·ªÉ t·∫°o payload t·∫•n c√¥ng hi·ªáu qu·∫£ h∆°n.

- **Bi·ªán ph√°p ph√≤ng ng·ª´a:**
  - **T·∫Øt ch·∫ø ƒë·ªô debug** trong m√¥i tr∆∞·ªùng production.
  - **Gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p** v√†o c√°c file log.
  - **Kh√¥ng ghi th√¥ng tin nh·∫°y c·∫£m** v√†o log ho·∫∑c th√¥ng b√°o l·ªói.

**Solution**
L∆∞·ªõt m·ªôt v√≤ng trang web kh√¥ng th·∫•y c√≥ g√¨ kh·∫£ nghi. D√πng ffuf ƒë·ªÉ t√¨m ki·∫øm th√™m th√¥ng tin.
·ªû b√†i lab n√†y l√† debugging n√™n ta s·∫Ω t√¨m n∆°i m√† c√≥ ch·∫ø ƒë·ªô debug n√†y.
`ffuf -u https://0a060042045671ca8027856700b8003b.web-security-academy.net/FUZZ -w /usr/share/ffuf/wordlists/common.t
xt`
![alt text](image-1.png)

Ki√™·ªÉm tra cac d∆∞∆°ng dan moi fuzz d∆∞∆°c
![alt text](image-2.png)
üí°Gi·∫£i th√≠ch
·ªû ƒë√¢y m√°y ch·ªß enable `Directory listing` d·∫´n ƒë·∫øn t√¨nh tr·∫°ng nh∆∞ tr√™n.
Ch√∫ng ta c√≥ th·ªÉ truy c·∫≠p v√†o phpinfo.php ƒë·ªÉ xem th√™m th√¥ng tin.

![alt text](image-3.png)
‚úÖ Key `2 2.3.31`

### Lab: Source code disclosure via backup files
**Source Code Disclosure via Backup Files**
- **R·ªßi ro:** Truy c·∫≠p ƒë∆∞·ª£c m√£ ngu·ªìn gi√∫p k·∫ª t·∫•n c√¥ng d·ªÖ hi·ªÉu h√†nh vi ·ª©ng d·ª•ng v√† th·ª±c hi·ªán c√°c cu·ªôc t·∫•n c√¥ng nghi√™m tr·ªçng h∆°n (RCE, SQLi,...).
- **Th√¥ng tin nh·∫°y c·∫£m:** M√£ ngu·ªìn th∆∞·ªùng ch·ª©a **API keys**, **th√¥ng tin ƒëƒÉng nh·∫≠p back-end** ƒë∆∞·ª£c hard-code s·∫µn.
- **Khai th√°c:**  
  - T√¨m c√°c file m√£ ngu·ªìn b·ªã l·ªô nh∆∞ `index.php~`, `config.bak`, `backup.zip`.  
  - M√°y ch·ªß th∆∞·ªùng th·ª±c thi file `.php`, nh∆∞ng v·ªõi file backup, n·ªôi dung m√£ ngu·ªìn c√≥ th·ªÉ ƒë∆∞·ª£c tr·∫£ v·ªÅ d∆∞·ªõi d·∫°ng text.  
  - **D·∫•u hi·ªáu nh·∫≠n bi·∫øt file backup:**  
    - K√Ω t·ª± `~` ·ªü cu·ªëi t√™n file (VD: `login.php~`)  
    - ƒêu√¥i file l·∫° nh∆∞ `.bak`, `.old`, `.swp`  

**Solution**
Ti·∫øp t·ª•c d√πng ffuf ƒë·ªÉ ki·ªÉm tra c√°c th∆∞ m·ª•c ho·∫∑c file tr√™n URL m·ª•c ti√™u.
![alt text](image-4.png)
Th·∫•y ngay th∆∞ m·ª•c backup -> truy c·∫≠p v√† xem nh∆∞ n√†o.
üí°: Ta th·∫•y ƒë∆∞·ª£c source code. Password database ƒë∆∞·ª£c l∆∞u d·∫°ng hardcode (r·∫•t nguy hi·ªÉm).
![alt text](image-5.png)
‚úÖ Key `e9w70mx78f57qxckutty3wsu3o63dkz8`

### Lab: Source code disclosure via backup files
**Source Code Disclosure via Backup Files**
- **R·ªßi ro:** Truy c·∫≠p ƒë∆∞·ª£c m√£ ngu·ªìn gi√∫p k·∫ª t·∫•n c√¥ng d·ªÖ hi·ªÉu h√†nh vi ·ª©ng d·ª•ng v√† th·ª±c hi·ªán c√°c cu·ªôc t·∫•n c√¥ng nghi√™m tr·ªçng h∆°n (RCE, SQLi,...).
- **Th√¥ng tin nh·∫°y c·∫£m:** M√£ ngu·ªìn th∆∞·ªùng ch·ª©a **API keys**, **th√¥ng tin ƒëƒÉng nh·∫≠p back-end** ƒë∆∞·ª£c hard-code s·∫µn.
- **Khai th√°c:**  
  - T√¨m c√°c file m√£ ngu·ªìn b·ªã l·ªô nh∆∞ `index.php~`, `config.bak`, `backup.zip`.  
  - M√°y ch·ªß th∆∞·ªùng th·ª±c thi file `.php`, nh∆∞ng v·ªõi file backup, n·ªôi dung m√£ ngu·ªìn c√≥ th·ªÉ ƒë∆∞·ª£c tr·∫£ v·ªÅ d∆∞·ªõi d·∫°ng text.  
  - **D·∫•u hi·ªáu nh·∫≠n bi·∫øt file backup:**  
    - K√Ω t·ª± `~` ·ªü cu·ªëi t√™n file (VD: `login.php~`)  
    - ƒêu√¥i file l·∫° nh∆∞ `.bak`, `.old`, `.swp`  

**Solution**
Ti·∫øp t·ª•c d√πng ffuf ƒë·ªÉ ki·ªÉm tra c√°c th∆∞ m·ª•c ho·∫∑c file tr√™n URL m·ª•c ti√™u.
![alt text](image-4.png)
Th·∫•y ngay th∆∞ m·ª•c backup -> truy c·∫≠p v√† xem nh∆∞ n√†o.
üí°: Ta th·∫•y ƒë∆∞·ª£c source code. Password database ƒë∆∞·ª£c l∆∞u d·∫°ng hardcode (r·∫•t nguy hi·ªÉm).
![alt text](image-5.png)
‚úÖ Key `e9w70mx78f57qxckutty3wsu3o63dkz8`

### Lab: Authentication bypass via information disclosure
**Insecure configuration**
- **Nguy√™n nh√¢n:** Do c·∫•u h√¨nh sai ho·∫∑c kh√¥ng an to√†n khi tri·ªÉn khai c√°c c√¥ng ngh·ªá b√™n th·ª© ba m√† kh√¥ng hi·ªÉu r√µ c√°c t√πy ch·ªçn c·∫•u h√¨nh.  
- **L·ªói ph·ªï bi·∫øn:** Qu√™n t·∫Øt c√°c t√πy ch·ªçn debug trong m√¥i tr∆∞·ªùng production.  
- **V√≠ d·ª•:**  
  - **HTTP TRACE**: Khi b·∫≠t, server s·∫Ω ph·∫£n h·ªìi l·∫°i to√†n b·ªô y√™u c·∫ßu g·ªëc. ƒêi·ªÅu n√†y c√≥ th·ªÉ v√¥ t√¨nh ti·∫øt l·ªô th√¥ng tin nh·∫°y c·∫£m nh∆∞ **header x√°c th·ª±c n·ªôi b·ªô** t·ª´ proxy ng∆∞·ª£c (reverse proxy).  
- **R·ªßi ro:** L·ªô th√¥ng tin c·∫•u tr√∫c h·ªá th·ªëng, token, ho·∫∑c th√¥ng tin x√°c th·ª±c.

**Solution**
ƒêƒÉng nh·∫≠p v·ªõi t√†i kho·∫£n ƒë∆∞·ª£c cho s·∫µn. T√¨m ki·∫øm v√† ƒë·ªÉ √Ω c√°c header HTTP c·ªßa g√≥i tin b·∫Øt ƒë∆∞·ª£c qua Burp.
Well! ch∆∞a c√≥ g√¨ h·ªØu √≠ch l·∫Øm. D√πng ffuf ƒë·ªÉ t√¨m ki·∫øm c√°c file ho·∫∑c th∆∞ m·ª•c ·∫©n kh√°c.
![alt text](image-6.png)
Truy c·∫≠p admin xem sao. N√≥ hi·ªán th√¥ng b√°o kh√¥ng truy c·∫≠p. B·∫Øt g√≥i tin tr√™n Burp th·ª≠ thay ƒë·ªïi method `TRACE` xem c√≥ th√¥ng tin g√¨ b·ªã r√≤ r·ªâ kh√¥ng?
![alt text](image-7.png)
üí°: G√≥i tin HTTP lu√¥n ƒë∆∞·ª£c g·∫Øn k√®m header `X-Custom-Ip-Authorization`. C√≥ l·∫Ω backend s·ª≠ d·ª•ng header n√†y ƒë·ªÉ ki·ªÉm tra IP tr∆∞·ªõc khi quy·∫øt ƒë·ªãnh cho truy c·∫≠p admin panel. V·∫≠y th·ª≠ ƒë·ªïi gi√° tr·ªã IP ƒë√≥ th√†nh `127.0.0.1`.
![alt text](image-8.png)
=> Gi·ªù th√¨ thay ƒë·ªïi g√≥i tin ƒë·ªÉ x√≥a carlos l√† xong. Thay `GET /admin/delete?username=carlos` v√†o g√≥i tin tr√™n.

‚úÖ Solved!
‚ö†Ô∏è **NOTE**: method `TRACE` th·ª±c s·ª± h·ªØu √≠ch trong vi·ªác x√°c ƒë·ªãnh c√°c header ·∫©n.